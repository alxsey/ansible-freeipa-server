---

- hosts: localhost
  remote_user: root
  gather_facts: true

  vars:
    freeipa_server_manage_host: false
    freeipa_server_admin_password: Passw0rd
    freeipa_server_domain: example.com
    freeipa_server_ds_password: Passw0rd
    freeipa_server_fqdn: "{{ ansible_fqdn }}"
    freeipa_server_ip: "{{ ansible_enp0s8['ipv4']['address'] }}"
    freeipa_server_realm: EXAMPLE.COM
    freeipa_server_install_options:
      - "--realm={{ freeipa_server_realm }}"
      - "--domain={{ freeipa_server_domain }}"
      - '--setup-dns'
      - "--ds-password {{ freeipa_server_ds_password }}"
      - "--admin-password {{ freeipa_server_admin_password }}"
      - '--mkhomedir'
      - "--hostname={{ freeipa_server_fqdn | default(ansible_fqdn) }}"
      - "--ip-address={{ freeipa_server_ip }}"
      - '--no-host-dns'
      - '--no-ntp'
      - '--idstart=5000'
      - '--ssh-trust-dns'
      - '--forwarder=8.8.8.8'
      - '--auto-forwarders'
      - '--allow-zone-overlap'

  roles:
    - timorunge.freeipa-server
